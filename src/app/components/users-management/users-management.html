<mat-card class="users-card">
  <mat-card-content>
    <!-- Indicateur de chargement -->
    <div *ngIf="isLoading" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Chargement des utilisateurs...</p>
    </div>

    <!-- Message d'erreur -->
    <div *ngIf="error && !isLoading" class="error-container">
      <mat-icon class="error-icon">error</mat-icon>
      <p>{{error}}</p>
      <button mat-raised-button color="primary" (click)="loadUsers()">Réessayer</button>
    </div>

    <!-- Tableau des utilisateurs -->
    <div *ngIf="!isLoading && !error" class="table-container">
      <table mat-table [dataSource]="users" class="users-table">

        <!-- ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef class="header-cell">ID</th>
          <td mat-cell *matCellDef="let user" class="data-cell">
            <span class="user-id">#{{user.id}}</span>
          </td>
        </ng-container>

        <!-- User Info Column -->
        <ng-container matColumnDef="userInfo">
          <th mat-header-cell *matHeaderCellDef class="header-cell">Utilisateur</th>
          <td mat-cell *matCellDef="let user" class="data-cell">
            <div class="user-info">
              <div class="user-name">{{user.prenom}} {{user.nom}}</div>
              <div class="user-email">{{user.email}}</div>
            </div>
          </td>
        </ng-container>

        <!-- Role Column -->
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef class="header-cell">Rôle</th>
          <td mat-cell *matCellDef="let user" class="data-cell">
            <span class="role-badge" [ngClass]="getRoleBadgeClass(user.role)">
              {{user.role}}
            </span>
          </td>
        </ng-container>

        <!-- Created At Column -->
        <ng-container matColumnDef="createdAt">
          <th mat-header-cell *matHeaderCellDef class="header-cell">Créé le</th>
          <td mat-cell *matCellDef="let user" class="data-cell">
            <div class="date-info">
              <div class="date-text">{{formatDate(user.createdAt)}}</div>
            </div>
          </td>
        </ng-container>

        <!-- Updated At Column -->
        <ng-container matColumnDef="updatedAt">
          <th mat-header-cell *matHeaderCellDef class="header-cell">Modifié le</th>
          <td mat-cell *matCellDef="let user" class="data-cell">
            <div class="date-info">
              <div class="date-text">{{formatDate(user.updatedAt)}}</div>
            </div>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="header-cell">Actions</th>
          <td mat-cell *matCellDef="let user" class="data-cell actions-cell">
            <button 
              mat-icon-button 
              class="delete-btn"
              matTooltip="Supprimer l'utilisateur"
              [disabled]="user.role === 'admin'"
              (click)="deleteUser(user)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>
      </table>

      <!-- Message si aucun utilisateur -->
      <div *ngIf="users.length === 0" class="no-data">
        <mat-icon>people_outline</mat-icon>
        <p>Aucun utilisateur trouvé</p>
      </div>
    </div>
  </mat-card-content>
</mat-card>
